parameters:

  deal.data.class: Deal

  deal.handler.class: Heystack\Subsystem\Deals\DealHandler

  deal.subscriber.class: Heystack\Subsystem\Deals\Subscriber

  deal.condition.configuration.class: Heystack\Subsystem\Deals\AdaptableConfiguration
  deal.condition.time.class: Heystack\Subsystem\Deals\Condition\Time
  deal.condition.purchasable.class: Heystack\Subsystem\Deals\Condition\Purchasable
  deal.condition.amount.class: Heystack\Subsystem\Deals\Condition\Amount
  deal.condition.items.class: Heystack\Subsystem\Deals\Condition\Items

  deal.result.configuration.class: Heystack\Subsystem\Deals\AdaptableConfiguration
  deal.result.fixedprice.class: Heystack\Subsystem\Deals\Result\FixedPrice
  deal.result.relativeprice.class: Heystack\Subsystem\Deals\Result\RelativePrice
  deal.result.freepurchasable.class: Heystack\Subsystem\Deals\Result\FreePurchasable
  deal.result.shipping.class: Heystack\Subsystem\Deals\Result\Shipping
  deal.result.cartdiscount.class: Heystack\Subsystem\Deals\Result\CartDiscount

services:
  deals.deal_handler:
    class: %deal.handler.class%
    arguments: [@state, @event_dispatcher]
    abstract: true

  deals.subscriber:
    class: %deal.subscriber.class%
    arguments: [@event_dispatcher, @storage]
    abstract: true

  deals.condition.configuration:
    class: %deal.condition.configuration.class%
    abstract: true

  deals.condition.time:
    class: %deal.condition.time.class%
    abstract: true

  deals.condition.purchasable:
    class: %deal.condition.purchasable.class%
    arguments: [@productholder]
    abstract: true

  deals.condition.amount:
      class: %deal.condition.amount.class%
      arguments: [@productholder, @currency_service]
      abstract: true

  deals.condition.items:
      class: %deal.condition.items.class%
      arguments: [@productholder]
      abstract: true

  deals.result.configuration:
    class: %deal.result.configuration.class%
    abstract: true

  deals.result.fixedprice:
    class: %deal.result.fixedprice.class%
    arguments: [@event_dispatcher, @productholder]
    abstract: true

  deals.result.relativeprice:
    class: %deal.result.relativeprice.class%
    arguments: [@event_dispatcher, @productholder]
    abstract: true

  deals.result.freepurchasable:
    class: %deal.result.freepurchasable.class%
    arguments: [@event_dispatcher, @productholder, @state, @dataobject_handler]
    abstract: true

  deals.result.shipping:
    class: %deal.result.shipping.class%
    arguments: [@event_dispatcher, @shipping_service, @currency_service]
    abstract: true

  deals.result.cartdiscount:
    class: %deal.result.cartdiscount.class%
    arguments: [@event_dispatcher, @productholder, @currency_service]
    abstract: true

  dealhandler_schema:
    class: %yaml_data_object_schema.class%
    arguments: [ ecommerce-deals/config/storage/dealhandler.yml, @state_global ]
    tags:
      - { name: dataobject_generator.schema }

  transaction_dealhandler_schema:
    class: %yaml_data_object_schema.class%
    arguments: [ ecommerce-deals/config/storage/transaction_dealhandler.yml, @state_global ]
    tags:
      - { name: dataobject_generator.schema }